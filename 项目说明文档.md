# 品牌管理系统 - C# 版本

## 项目概述

本项目是一个品牌管理系统，从 Java (Servlet + MyBatis + Vue.js) 技术栈转换为 C# (ASP.NET Core + Entity Framework Core + Blazor) 技术栈。

## 技术栈

| 层级 | 技术 | 版本 |
|------|------|------|
| 运行时 | .NET | 9.0 |
| 后端框架 | ASP.NET Core Web API | 9.0 |
| ORM | Entity Framework Core | 9.0 |
| 数据库 | MySQL | 5.x / 8.x |
| 数据库驱动 | Pomelo.EntityFrameworkCore.MySql | 9.0 |
| 前端框架 | Blazor Server | 9.0 |
| UI 组件库 | MudBlazor | 7.8.0 |

## 项目结构

```
BrandCase/
├── BrandCase.sln                           # 解决方案文件
│
├── BrandCase.Core/                         # 核心业务层（类库）
│   ├── Entities/
│   │   └── Brand.cs                        # 品牌实体类
│   ├── DTOs/
│   │   ├── PagedResult.cs                  # 分页结果 DTO
│   │   └── BrandQueryDto.cs                # 查询条件 DTO
│   └── Interfaces/
│       └── IBrandService.cs                # 品牌服务接口
│
├── BrandCase.Infrastructure/               # 基础设施层（类库）
│   ├── Data/
│   │   └── AppDbContext.cs                 # EF Core 数据库上下文
│   └── Services/
│       └── BrandService.cs                 # 品牌服务实现
│
├── BrandCase.Api/                          # Web API 项目
│   ├── Controllers/
│   │   └── BrandController.cs              # 品牌 API 控制器
│   ├── Program.cs                          # API 入口和配置
│   └── appsettings.json                    # 配置文件
│
└── BrandCase.Blazor/                       # Blazor Server 前端项目
    ├── Pages/
    │   ├── Index.razor                     # 首页
    │   └── BrandManagement.razor           # 品牌管理页面
    ├── Components/
    │   └── BrandDialog.razor               # 新增品牌对话框
    ├── Shared/
    │   ├── MainLayout.razor                # 主布局
    │   └── NavMenu.razor                   # 导航菜单
    ├── Program.cs                          # Blazor 入口和配置
    └── appsettings.json                    # 配置文件
```

## 功能模块

### 品牌管理
- **查询所有品牌** - 获取品牌列表
- **分页查询** - 支持分页浏览
- **条件筛选** - 按品牌名称、企业名称、状态筛选
- **新增品牌** - 添加新的品牌信息
- **批量删除** - 批量删除选中的品牌

## 数据库配置

### 数据库表结构

项目复用原有 MySQL 数据库，表结构如下：

```sql
CREATE TABLE tb_brand (
    id INT PRIMARY KEY AUTO_INCREMENT COMMENT '主键',
    brand_name VARCHAR(100) COMMENT '品牌名称',
    company_name VARCHAR(100) COMMENT '企业名称',
    ordered INT COMMENT '排序',
    description VARCHAR(500) COMMENT '描述',
    status INT COMMENT '状态：0-禁用，1-启用'
);
```

### 连接字符串配置

在 `appsettings.json` 中配置数据库连接：

```json
{
  "ConnectionStrings": {
    "DefaultConnection": "Server=localhost;Database=db1;User=root;Password=root;"
  }
}
```

**配置说明：**
- `Server` - 数据库服务器地址
- `Database` - 数据库名称
- `User` - 数据库用户名
- `Password` - 数据库密码

## 快速开始

### 环境要求

- [.NET 9.0 SDK](https://dotnet.microsoft.com/download/dotnet/9.0)
- MySQL 5.7+ 或 8.0+
- IDE（推荐 Visual Studio 2022 或 VS Code）

### 运行步骤

#### 1. 克隆/下载项目

```bash
cd I:\brand-case\BrandCase
```

#### 2. 配置数据库连接

修改以下文件中的数据库连接字符串：
- `BrandCase.Api/appsettings.json`
- `BrandCase.Blazor/appsettings.json`

#### 3. 还原依赖包

```bash
dotnet restore
```

#### 4. 构建项目

```bash
dotnet build
```

#### 5. 运行应用

**方式一：运行 Blazor 应用（推荐，前后端一体）**

```bash
cd BrandCase.Blazor
dotnet run
```

访问：`https://localhost:5001` 或 `http://localhost:5000`

**方式二：运行 Web API（独立后端）**

```bash
cd BrandCase.Api
dotnet run
```

访问 Swagger UI：`https://localhost:5001/swagger`

## API 接口文档

### 基础路径
```
/api/Brand
```

### 接口列表

| 方法 | 路径 | 描述 | 请求体 |
|------|------|------|--------|
| GET | `/api/Brand` | 查询所有品牌 | - |
| POST | `/api/Brand` | 新增品牌 | Brand JSON |
| DELETE | `/api/Brand` | 批量删除 | int[] |
| GET | `/api/Brand/page` | 分页查询 | Query: currentPage, pageSize |
| POST | `/api/Brand/page` | 分页条件查询 | Query + BrandQueryDto |

### 请求/响应示例

#### 新增品牌
```http
POST /api/Brand
Content-Type: application/json

{
  "brandName": "华为",
  "companyName": "华为技术有限公司",
  "ordered": 1,
  "description": "全球领先的ICT解决方案提供商",
  "status": 1
}
```

#### 分页条件查询
```http
POST /api/Brand/page?currentPage=1&pageSize=10
Content-Type: application/json

{
  "brandName": "华",
  "companyName": "",
  "status": 1
}
```

**响应：**
```json
{
  "totalCount": 15,
  "rows": [
    {
      "id": 1,
      "brandName": "华为",
      "companyName": "华为技术有限公司",
      "ordered": 1,
      "description": "全球领先的ICT解决方案提供商",
      "status": 1,
      "statusStr": "启用"
    }
  ]
}
```

#### 批量删除
```http
DELETE /api/Brand
Content-Type: application/json

[1, 2, 3]
```

## 项目架构

```
┌─────────────────────────────────────────────────────────┐
│                    Blazor Server                         │
│                 (MudBlazor UI 组件)                      │
└─────────────────────────────────────────────────────────┘
                          │
                          ▼
┌─────────────────────────────────────────────────────────┐
│                   ASP.NET Core                           │
│              (Web API / Blazor Hub)                      │
└─────────────────────────────────────────────────────────┘
                          │
                          ▼
┌─────────────────────────────────────────────────────────┐
│                  BrandService                            │
│                   (业务逻辑层)                           │
└─────────────────────────────────────────────────────────┘
                          │
                          ▼
┌─────────────────────────────────────────────────────────┐
│              Entity Framework Core                       │
│                  (数据访问层)                            │
└─────────────────────────────────────────────────────────┘
                          │
                          ▼
┌─────────────────────────────────────────────────────────┐
│                     MySQL                                │
│                   (tb_brand)                             │
└─────────────────────────────────────────────────────────┘
```

## 与 Java 版本的对照

| 功能 | Java 实现 | C# 实现 |
|------|-----------|---------|
| Web 框架 | Servlet 3.1 | ASP.NET Core 9 |
| 路由 | @WebServlet + 反射 | [ApiController] + 属性路由 |
| ORM | MyBatis | Entity Framework Core |
| JSON 处理 | FastJSON | System.Text.Json |
| 前端框架 | Vue.js + Element UI | Blazor Server + MudBlazor |
| 依赖注入 | 手动创建 | 内置 DI 容器 |
| 异步支持 | 同步 | async/await |

## 开发说明

### 添加新实体

1. 在 `BrandCase.Core/Entities` 中创建实体类
2. 在 `AppDbContext` 中添加 `DbSet<T>`
3. 在 `BrandCase.Core/Interfaces` 中定义服务接口
4. 在 `BrandCase.Infrastructure/Services` 中实现服务
5. 在 `Program.cs` 中注册服务

### 数据库迁移

```bash
# 添加迁移
dotnet ef migrations add InitialCreate -p BrandCase.Infrastructure -s BrandCase.Api

# 更新数据库
dotnet ef database update -p BrandCase.Infrastructure -s BrandCase.Api
```

## 注意事项

1. **数据库连接**：确保 MySQL 服务已启动，且连接字符串配置正确
2. **端口冲突**：如遇端口冲突，可在 `launchSettings.json` 中修改端口
3. **HTTPS 证书**：开发环境首次运行可能需要信任开发证书：
   ```bash
   dotnet dev-certs https --trust
   ```

## 许可证

本项目仅供学习参考使用。
